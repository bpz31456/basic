## kafka
### kafka简介
* kafka消息通过主题来区分（相当于一张数据库的表），每个主题包含一个或多个分区，每个分区的消息有先后顺序
* 通过流来统称一个消息中的数据
* kafka的用户分为生产者和消费者，之外还有高级的客户端，数据集成的kafka connect api和流处理的kafka streams
  * 生产者发布消息，一个消息会发布到一个主题上，不用关心会发布到哪个具体的分区上
  * 消费者读取消息，消费者订阅一个或多个主题，按照消息的生产顺序读取，消费者通过检查偏移量来确定消息是否读取，是一个整数
  * 消费者把每个消息的读取偏移量保存到zookeeper或kafka中
* 消费者是消费者群的一部分，会有一个或多个消费者读取一个主题，群组保证每个分区只能被一个消费者读取，每个消费者可以读取多个分区
  * 消费者和分区的关系称为所有权关系
  * 如果一个消费者失效，群组会安排其他消费接管这个分区
* 每个独立的kafka服务器称为broker，broker接受来自生产者的消息，broker为消费者提供服务，设置偏移量，提交消息到磁盘，对读取分区请求作出响应
  * broker是集群的一部分，每个集群有一个broker充当集群控制器（集群自动选举）
* 保留消息，kafka默认消息保留策略，保留7天或超过1g的消息就会失效被删除
* kafka消息中间件特点
  * 多个生产者
  * 多个消费者
  * 基于磁盘数据存储
  * 伸缩性
  * 高性能
* 使用场景
  * 活动追踪
  * 传递消息
  * 度量指标和日志记录
  * 提交日志
  * 流处理
### kafka使用
* kafka通过zookeeper保存集群元数据和消费者信息
* zookeeper默认端口2181
* 
## 日志框架
## 负载均衡
## 缓存
### 缓存算法
* 保存策略，最近最常使用（MRU）
* 回收策略，最近最少使用（LRU）
* 保存策略，最常使用（MFU）
* 回收策略，最少使用（LFU）
* 回收策略，不常使用（NFU）
### 缓存的状态，热度，用来表示缓存命中率的形象
* 冷，无数据或缓存的无效数据，缓存命中率为0
* 温，有缓存数据，但是命中率不高
* 热，有缓存数据，命中率高

### 分布式缓存

## 性能
### 资源分析，分析资源使用率，是否已经进入极限
`vmstat` `iostat` `mpstat`
* IOPS
* 吞吐量
* 使用率
* 饱和度
### 工作负载分析，工作负载和应用程序如何响应
* 请求，所施加的工作负载
* 吞吐量，每秒业务处理量
* 延时，应用程序的响应时间
* 完成度，查找错误

### 诊断方法
* 错误的方法，用户不知道用什么方法来诊断问题，如，使用top命令，随便查查，可能诊断出问题
* 头疼医头脚疼医脚，用户猜测问题出在那里，然后使用相应命令诊断和优化，问题处理之后可能还会出现其他问题，依次循环处理，耗时长，不稳定
* 推卸责任，甩锅，缺乏数据支撑的臆想，不针对问题本身，抛给其他项目组
* 